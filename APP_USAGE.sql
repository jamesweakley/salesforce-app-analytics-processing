create or replace view APP_USAGE(
	UNIQUE_ID,
	TIMESTAMP,
	LOG_RECORD_TYPE,
	REQUEST_ID,
	ORGANIZATION_ID,
	CLONED_FROM_ORGANIZATION_ID,
	ORGANIZATION_NAME,
	ORGANIZATION_STATUS,
	ORGANIZATION_EDITION,
	USER_ID_TOKEN,
	USER_TYPE,
	URL,
	PACKAGE_ID,
	PACKAGE_VERSION_ID,
	CUSTOM_ENTITY,
	CUSTOM_ENTITY_TYPE,
	OPERATION_COUNT,
	USER_COUNTRY_CODE,
	USER_TIME_ZONE,
	ROWS_PROCESSED,
	REQUEST_SIZE,
	RESPONSE_SIZE,
	METHOD_NAME
) as(
select
  hash(REQUEST_ID||'|'||CUSTOM_ENTITY)::varchar(255) as UNIQUE_ID,
  to_timestamp(TIMESTAMP_DERIVED) as TIMESTAMP,
  LOG_RECORD_TYPE::varchar(255) as LOG_RECORD_TYPE,
  REQUEST_ID::varchar(255) as REQUEST_ID,
  ORGANIZATION_ID::varchar(255) as ORGANIZATION_ID,
  CLONED_FROM_ORGANIZATION_ID::varchar(255) as CLONED_FROM_ORGANIZATION_ID,
  ORGANIZATION_NAME::varchar(255) as ORGANIZATION_NAME,
  ORGANIZATION_STATUS::varchar(255) as ORGANIZATION_STATUS,
  ORGANIZATION_EDITION::varchar(255) as ORGANIZATION_EDITION,
  USER_ID_TOKEN::varchar(255) as USER_ID_TOKEN,
  USER_TYPE::varchar(255) as USER_TYPE,
  URL::varchar(255) as URL,
  PACKAGE_ID::varchar(255) as PACKAGE_ID,
  PACKAGE_VERSION_ID::varchar(255) as PACKAGE_VERSION_ID,
  CUSTOM_ENTITY::varchar(255) as CUSTOM_ENTITY,
  CUSTOM_ENTITY_TYPE::varchar(255) as CUSTOM_ENTITY_TYPE,
  OPERATION_COUNT::number(10,0) as OPERATION_COUNT,
  USER_COUNTRY_CODE::varchar(255) as USER_COUNTRY_CODE,
  USER_TIME_ZONE::varchar(255) as USER_TIME_ZONE,
  ROWS_PROCESSED::number(10,0) as ROWS_PROCESSED,
  REQUEST_SIZE::number(10,0) as REQUEST_SIZE,
  RESPONSE_SIZE::number(10,0) as RESPONSE_SIZE,
  METHOD_NAME::varchar(255) as METHOD_NAME
  from APP_ANALYTICS
);
